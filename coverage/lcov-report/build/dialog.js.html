<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for build/dialog.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">build/</a> dialog.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">89.33% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>67/75</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">74.07% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>40/54</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">90% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>9/10</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">91.55% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>65/71</span>
      </div>
    </div>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211</td><td class="line-coverage quiet"><span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-yes">16×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-yes">16×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-yes">279×</span>
<span class="cline-any cline-yes">268×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">19×</span>
<span class="cline-any cline-yes">21×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">11×</span>
<span class="cline-any cline-yes">279×</span>
<span class="cline-any cline-yes">268×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">12×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">(function (global, factory) {
  typeof exports === 'object' &amp;&amp; <span class="branch-1 cbranch-no" title="branch not covered" >typeof module !== 'undefined' </span>? <span class="branch-0 cbranch-no" title="branch not covered" >factory(exports) </span>: typeof define === 'function' &amp;&amp; <span class="branch-1 cbranch-no" title="branch not covered" >define.amd </span>? <span class="branch-0 cbranch-no" title="branch not covered" >define(['exports'], factory) </span>: factory(global.a11yEnhancer = global.a11yEnhancer || <span class="branch-1 cbranch-no" title="branch not covered" >{})</span>;
})(this, function (exports) {
  'use strict';
&nbsp;
  /**
   * CustomEvent polyfill.
   */
&nbsp;
  var CustomEvent = function () {
    <span class="missing-if-branch" title="else path not taken" >E</span>if (typeof window.CustomEvent === "function") return window.CustomEvent;
&nbsp;
<span class="fstat-no" title="function not covered" >    function CustomEvent(event, params) {</span>
<span class="cstat-no" title="statement not covered" >      params = params || { bubbles: false, cancelable: false, detail: undefined };</span>
<span class="cstat-no" title="statement not covered" >      var evt = document.createEvent('CustomEvent');</span>
<span class="cstat-no" title="statement not covered" >      evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);</span>
<span class="cstat-no" title="statement not covered" >      return evt;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    CustomEvent.prototype = window.Event.prototype;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    return CustomEvent;</span>
  }();
&nbsp;
  /**
   * Define commonly used keycodes for interacting with components.
   */
&nbsp;
  var esc = 27;
&nbsp;
  var TITLE_ID = 'ae_dialog-heading';
&nbsp;
  // unique id for each dialog heading
  var uid = 1;
&nbsp;
  /**
   * Implements an accessible accordion menu with proper state and focus support.
   * @see https://www.w3.org/TR/wai-aria-practices/#dialog_modal
   *
   * @param {HTMLElement} element - Container element of the accordion.
   * @param {ShadowRoot} [shadfowRoot=element] - Shadow root element if using a custom element with shadow root. Defaults to the container element.
   *
   * For this to work, the modal must be given the role="dialog". The element will be moved
   * to be a direct child of body. This ensures there are no z-index problems and that the
   * modal can trap keyboard focus easily by adding the inert attribute to all it's siblings.
   *
   * This implementation also requires the inert polyfill (npm install --save wicg-inert).
   *
   * By default, the modal is of type modal. This means that keyboard interactions are trapped
   * to the modal when it is opened and the rest of the page cannot be interacted with.
   *
   * Optional attributes on container element
   *
   *    modeless - A modeless dialog
   *    no-esc - Don't close the modal on escape key
   *
   * Events will pass the target element as the detail property of the event
   *
   *    modal-opened - fired when the modal is opened
   *    modal-closed - fired when the modal is closed
   */
  function dialog(element, shadowRoot) {
    // ensure we are a DOM element and have proper element functions
    <span class="missing-if-branch" title="if path not taken" >I</span>if (!element instanceof HTMLElement) <span class="cstat-no" title="statement not covered" >return;</span>
&nbsp;
    // if no shadowRoot is passed default to the container element
    // using toString() is the only safe way to check for a shadow root node when
    // the polyfill is not loaded
    var root = shadowRoot &amp;&amp; <span class="branch-1 cbranch-no" title="branch not covered" >shadowRoot.toString() === '[object ShadowRoot]' </span>? <span class="branch-0 cbranch-no" title="branch not covered" >shadowRoot </span>: element;
&nbsp;
    // states
    var previousActiveElement = void 0;
&nbsp;
    // options
    var OPTIONS = {
      modeless: element.hasAttribute('modeless'),
      noEsc: element.hasAttribute('no-esc')
    };
&nbsp;
    // the role could be on the element or one of it's children
    var dialog = element.getAttribute('role') === 'dialog' ? element : root.querySelector('[role="dialog"]');
&nbsp;
    // allow the dialog to be focusable when opened
    // @see https://github.com/whatwg/html/issues/1929
    dialog.setAttribute('tabindex', -1);
    dialog.style.outline = 'none';
&nbsp;
    // move the dialog to be a direct child of body if it's not already. this both resolves any
    // z-index problems and makes disabling the rest of the page easier (just query selector
    // everything under body except the dialog)
    <span class="missing-if-branch" title="else path not taken" >E</span>if (root.parentElement !== document.body) {
      document.body.appendChild(root);
    }
&nbsp;
    // find the first heading and make it the label to the dialog
    var title = dialog.querySelector('h1,h2,h3,h4,h5,h6');
    if (!title.hasAttribute('id')) {
      title.setAttribute('id', TITLE_ID + uid++);
    }
&nbsp;
    // only set the label if it's not already set
    if (!dialog.hasAttribute('aria-labelledby')) {
      dialog.setAttribute('aria-labelledby', title.getAttribute('id'));
    }
&nbsp;
    // give the dialog an open and close method that can be called externally
    /**
     * Open the dialog.
     */
    dialog.open = function () {
      <span class="missing-if-branch" title="if path not taken" >I</span>if (this.hasAttribute('open')) <span class="cstat-no" title="statement not covered" >return;</span>
&nbsp;
      previousActiveElement = document.activeElement;
&nbsp;
      if (!OPTIONS.modeless) {
&nbsp;
        // prevent page from scrolling while open
        document.body.style.overflow = 'hidden';
&nbsp;
        // make all siblings of the dialog inert if it's a modal
        Array.from(document.body.children).forEach(function (child) {
          if (child !== root) {
            child.inert = true;
          }
        });
      }
&nbsp;
      this.setAttribute('open', '');
&nbsp;
      // event listeners
      document.addEventListener('click', checkCloseDialog, true);
&nbsp;
      if (!OPTIONS.noEsc) {
        document.addEventListener('keydown', checkCloseDialog, true);
      }
&nbsp;
      // focus the dialog if no element has autofocus attribute
      if (!dialog.querySelector('[autofocus]')) {
        this.focus();
      } else {
        dialog.querySelector('[autofocus]').focus();
      }
&nbsp;
      root.dispatchEvent(new CustomEvent('modal-opened', { detail: this }));
    };
&nbsp;
    /**
     * Close the dialog.
     */
    dialog.close = function () {
      if (!this.hasAttribute('open')) return;
&nbsp;
      if (!OPTIONS.modeless) {
        document.body.style.overflow = null;
&nbsp;
        // uninert all siblings
        Array.from(document.body.children).forEach(function (child) {
          if (child !== root) {
            child.inert = false;
          }
        });
      }
&nbsp;
      this.removeAttribute('open');
&nbsp;
      // remove event listeners
      document.removeEventListener('click', checkCloseDialog, true);
      document.removeEventListener('keydown', checkCloseDialog, true);
&nbsp;
      // focus the previous element
      previousActiveElement.focus();
      previousActiveElement = null;
&nbsp;
      root.dispatchEvent(new CustomEvent('modal-closed', { detail: this }));
    };
&nbsp;
    /**
     * Check for events that should close the dialog.
     * @param {Event} e
     */
    function checkCloseDialog(e) {
&nbsp;
      // check for escape on keydown
      if (e.type === 'keydown' &amp;&amp; e.which === esc) {
        dialog.close();
      }
&nbsp;
      // check if click happened outside of dialog
      else <span class="missing-if-branch" title="else path not taken" >E</span>if (e.type === 'click') {
          var el = e.target;
&nbsp;
          while (el.parentElement) {
            if (el === dialog) {
              break;
            }
&nbsp;
            el = el.parentElement;
          }
&nbsp;
          // close the dialog if the click happened outside of it
          if (el !== dialog) {
            dialog.close();
          }
        }
    }
  }
&nbsp;
  exports.dialog = dialog;
&nbsp;
  Object.defineProperty(exports, '__esModule', { value: true });
});</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sun Jun 18 2017 23:52:15 GMT-0600 (MDT)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
